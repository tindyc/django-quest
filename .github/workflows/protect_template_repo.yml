name: Protect Template Repository (Auto-Close Issues)

on:
  issues:
    types: [opened]

jobs:
  autoclose_issue:
    runs-on: ubuntu-latest

    steps:
      - name: Check if this is the main template repo
        id: check
        run: |
          # Replace with YOUR actual template repo path
          TEMPLATE_REPO="tindyc/django-quest"

          if [[ "${GITHUB_REPOSITORY}" == "$TEMPLATE_REPO" ]]; then
            echo "in_template=true" >> $GITHUB_OUTPUT
          else
            echo "in_template=false" >> $GITHUB_OUTPUT
          fi

      - name: Auto-close issue
        if: steps.check.outputs.in_template == 'true'
        uses: peter-evans/close-issue@v3
        with:
          issue-number: ${{ github.event.issue.number }}
          comment: |
            ðŸ‘‹ **Hello! It looks like you opened an Issue in the *template repository*.**

            This repo is **not** where you complete the Django Quest.

            To begin the workshop:

            1. Go back to the repository homepage  
            2. Click **Use this template â†’ Create a new repository**  
            3. Clone *your* new repo  
            4. Start by creating **Issue 1** in *your own repository*

            This issue has been closed automatically to keep the template clean.  
            See you on your Quest! ðŸš€
